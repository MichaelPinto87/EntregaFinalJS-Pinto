<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Nike</title>
    <link rel="icon" sizes="1x1 3x3 4x4" type="image/png" href="img/logonike.jpeg" />
    <link rel="stylesheet" href="styles.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css"
/>
<script>
  document.addEventListener('DOMContentLoaded', () => {

      // Variables
      const baseDeDatos = [
      {
    id: 12,
    nombre: "Remera Larga Nike ",
    categoria: "Remera",
    precio: 69.99,
    marca: "Nike",
    imagen: "img/Remera3.png",
    descripcion: "Remera manga larga Nike.",
  },
  {
    id: 6,
    nombre: "Pantalon Nike Jordan ",
    categoria: "Pantalones",
    precio: 39.99,
    marca: "Nike Jordan",
    imagen: "img/Pantalon2.png",
    descripcion: "Pantalon Nike Jordan MVP.",
  },,
  {
    id: 7,
    nombre: "Calza Nike",
    categoria: "Pantalon",
    precio: 39.99,
    marca: "Nike",
    imagen: "img/Pantalon3.png",
    descripcion: "Calza común Nike.",
  },
          {
              id: 4,
              nombre: 'Fresas',
              precio: 0.6,
              imagen: 'fresas.jpg'
          }

      ];

      let carrito = [];
      const divisa = '$';
      const DOMitems = document.querySelector('#items');
      const DOMcarrito = document.querySelector('#carrito');
      const DOMtotal = document.querySelector('#total');
      const DOMbotonVaciar = document.querySelector('#boton-vaciar');
      const miLocalStorage = window.localStorage;

      // Funciones

      /**
      * Dibuja todos los productos a partir de la base de datos. No confundir con el carrito
      */
      function renderizarProductos() {
          baseDeDatos.forEach((info) => {
              // Estructura
              const miNodo = document.createElement('div');
              miNodo.classList.add('card', 'col-sm-4');
              // Body
              const miNodoCardBody = document.createElement('div');
              miNodoCardBody.classList.add('card-body');
              // Titulo
              const miNodoTitle = document.createElement('h5');
              miNodoTitle.classList.add('card-title');
              miNodoTitle.textContent = info.nombre;
              // Imagen
              const miNodoImagen = document.createElement('img');
              miNodoImagen.classList.add('img-fluid');
              miNodoImagen.setAttribute('src', info.imagen);
              // Precio
              const miNodoPrecio = document.createElement('p');
              miNodoPrecio.classList.add('card-text');
              miNodoPrecio.textContent = `${info.precio}${divisa}`;
              // Boton 
              const miNodoBoton = document.createElement('button');
              miNodoBoton.classList.add('btn', 'btn-primary');
              miNodoBoton.textContent = '+';
              miNodoBoton.setAttribute('marcador', info.id);
              miNodoBoton.addEventListener('click', anyadirProductoAlCarrito);
              // Insertamos
              miNodoCardBody.appendChild(miNodoImagen);
              miNodoCardBody.appendChild(miNodoTitle);
              miNodoCardBody.appendChild(miNodoPrecio);
              miNodoCardBody.appendChild(miNodoBoton);
              miNodo.appendChild(miNodoCardBody);
              DOMitems.appendChild(miNodo);
          });
      }

      /**
      * Evento para añadir un producto al carrito de la compra
      */
      function anyadirProductoAlCarrito(evento) {
          // Anyadimos el Nodo a nuestro carrito
          carrito.push(evento.target.getAttribute('marcador'))
          // Actualizamos el carrito 
          renderizarCarrito();
          // Actualizamos el LocalStorage
          guardarCarritoEnLocalStorage();
      }

      /**
      * Dibuja todos los productos guardados en el carrito
      */
      function renderizarCarrito() {
          // Vaciamos todo el html
          DOMcarrito.textContent = '';
          // Quitamos los duplicados
          const carritoSinDuplicados = [...new Set(carrito)];
          // Generamos los Nodos a partir de carrito
          carritoSinDuplicados.forEach((item) => {
              // Obtenemos el item que necesitamos de la variable base de datos
              const miItem = baseDeDatos.filter((itemBaseDatos) => {
                  // ¿Coincide las id? Solo puede existir un caso
                  return itemBaseDatos.id === parseInt(item);
              });
              // Cuenta el número de veces que se repite el producto
              const numeroUnidadesItem = carrito.reduce((total, itemId) => {
                  // ¿Coincide las id? Incremento el contador, en caso contrario no mantengo
                  return itemId === item ? total += 1 : total;
              }, 0);
              // Creamos el nodo del item del carrito
              const miNodo = document.createElement('li');
              miNodo.classList.add('list-group-item', 'text-right', 'mx-2');
              miNodo.textContent = `${numeroUnidadesItem} x ${miItem[0].nombre} - ${miItem[0].precio}${divisa}`;
              // Boton de borrar
              const miBoton = document.createElement('button');
              miBoton.classList.add('btn', 'btn-danger', 'mx-5');
              miBoton.textContent = 'X';
              miBoton.style.marginLeft = '1rem';
              miBoton.dataset.item = item;
              miBoton.addEventListener('click', borrarItemCarrito);
              // Mezclamos nodos
              miNodo.appendChild(miBoton);
              DOMcarrito.appendChild(miNodo);
          });
          // Renderizamos el precio total en el HTML
          DOMtotal.textContent = calcularTotal();
      }

      /**
      * Evento para borrar un elemento del carrito
      */
      function borrarItemCarrito(evento) {
          // Obtenemos el producto ID que hay en el boton pulsado
          const id = evento.target.dataset.item;
          // Borramos todos los productos
          carrito = carrito.filter((carritoId) => {
              return carritoId !== id;
          });
          // volvemos a renderizar
          renderizarCarrito();
          // Actualizamos el LocalStorage
          guardarCarritoEnLocalStorage();

      }

      /**
       * Calcula el precio total teniendo en cuenta los productos repetidos
       */
      function calcularTotal() {
          // Recorremos el array del carrito 
          return carrito.reduce((total, item) => {
              // De cada elemento obtenemos su precio
              const miItem = baseDeDatos.filter((itemBaseDatos) => {
                  return itemBaseDatos.id === parseInt(item);
              });
              // Los sumamos al total
              return total + miItem[0].precio;
          }, 0).toFixed(2);
      }

      /**
      * Varia el carrito y vuelve a dibujarlo
      */
      function vaciarCarrito() {
          // Limpiamos los productos guardados
          carrito = [];
          // Renderizamos los cambios
          renderizarCarrito();
          // Borra LocalStorage
          localStorage.clear();

      }

      function guardarCarritoEnLocalStorage () {
          miLocalStorage.setItem('carrito', JSON.stringify(carrito));
      }

      function cargarCarritoDeLocalStorage () {
          // ¿Existe un carrito previo guardado en LocalStorage?
          if (miLocalStorage.getItem('carrito') !== null) {
              // Carga la información
              carrito = JSON.parse(miLocalStorage.getItem('carrito'));
          }
      }

      // Eventos
      DOMbotonVaciar.addEventListener('click', vaciarCarrito);

      // Inicio
      cargarCarritoDeLocalStorage();
      renderizarProductos();
      renderizarCarrito();
  });
</script>
  </head>
  <body>
    
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
      <div class="container-fluid">
        
        <div class="logo">
          <svg
            role="img"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <title>Nike</title>
            <path
              d="M24 7.8L6.442 15.276c-1.456.616-2.679.925-3.668.925-1.12 0-1.933-.392-2.437-1.177-.317-.504-.41-1.143-.28-1.918.13-.775.476-1.6 1.036-2.478.467-.71 1.232-1.643 2.297-2.8a6.122 6.122 0 00-.784 1.848c-.28 1.195-.028 2.072.756 2.632.373.261.886.392 1.54.392.522 0 1.11-.084 1.764-.252L24 7.8z"
            />
          </svg>
        </div>
        <div class="nav-item" id="navbarNav">
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="../">Home</a>
            </li>
            <div class="nav-item" id="navbarNav">
              <ul class="navbar-nav">
                <li class="nav-item">
                  <a class="nav-link active" aria-current="page" href="#">Contacto</a>
                </li>
                <div class="nav-item" id="navbarNav">
                  <ul class="navbar-nav">
                    <li class="nav-item">
                      <a class="nav-link active" aria-current="page" href="#footer">Redes</a>
                    </li>
        <button>
      <div class="cart">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="1.5"
          stroke="currentColor"
          class="w-6 h-6"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M15.75 10.5V6a3.75 3.75 0 10-7.5 0v4.5m11.356-1.993l1.263 12c.07.665-.45 1.243-1.119 1.243H4.25a1.125 1.125 0 01-1.12-1.243l1.264-12A1.125 1.125 0 015.513 7.5h12.974c.576 0 1.059.435 1.119 1.007zM8.625 10.5a.375.375 0 11-.75 0 .375.375 0 01.75 0zm7.5 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"
          />
        </svg>
      </div></button>
      
      
    </nav>
    
    
  
    <button id="dark-mode-toggle">Modo Oscuro</button>
    

    <h1 class="Titulo">N i k e</h1>
    <div class="container-fluid">
      <div class="row">
        <div class="col">
          
          <div class="swiper">
            <!-- Additional required wrapper -->
            <div class="swiper-wrapper">
              <!-- Slides -->
              <div class="swiper-slide" style="background-image:url(img/carrusel3.jpg);
              background-size: 320px;" >
               </div>
              <div class="swiper-slide" style="background-image:url(img/carrusel2.jpg);
              background-size: 730px;"></div>
              <div class="swiper-slide" style="background-image:url(img/carrusel1.jpg);
              background-size: 285px;"></div>
              ...
            </div>
            
            
          
            <!-- If we need scrollbar -->
            <div class="swiper-scrollbar"></div>
          </div>
        </div>
      </div>
    </div>
    <!-- Slider main container -->

    
    
    <h2 class="Subtitulo"><hr>Vendedores numero1 en productos de vestimenta</h2>
<div class="container-fluid">
  <div class="row text-center">
    <div class="col-12">
      <p class="h1 pb-3 pt-3">Productos Recomendados</p>
      <div id="productos-container"></div>
    </div>
  </div>
</div>
<div class="container">
  <div class="row">
      <!-- Elementos generados a partir del JSON -->
      <main id="items" class="col-sm-8 row"></main>
      <!-- Carrito -->
      <aside class="col-sm-4">
          <h2>Carrito</h2>
          <!-- Elementos del carrito -->
          <ul id="carrito" class="list-group"></ul>
          <hr>
          <!-- Precio total -->
          <p class="text-right">Total: <span id="total"></span>&euro;</p>
          <button id="boton-vaciar" class="btn btn-danger">Vaciar</button>
      </aside>
  </div>
</div>
   <hr>
   <div id="footer">
<footer class="text-center text-white" style="background-color: #ffffff;">
  <!-- Grid container -->
  <div class="container pt-3">
    <!-- Section: Social media -->
    <section class="mb-4">
  

      <!-- Twitter -->
      <a
        class="btn btn-link btn-floating btn-lg text-dark m-1"
        href="#!"
        role="button"
        data-mdb-ripple-color="dark"
        ><i class="fab fa-twitter"><?xml version="1.0" ?><!DOCTYPE svg  PUBLIC '-//W3C//DTD SVG 1.1//EN'  'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'><img src="img/twitticon.png" alt=""></i
      ></a>

       <!-- Facebook -->
      <a
        class="btn btn-link btn-floating btn-lg text-dark m-1"
        href="#!"
        role="button"
        data-mdb-ripple-color="dark"
        ><i class="fab fa-facebook-f"><?xml version="1.0" ?><!DOCTYPE svg  PUBLIC '-//W3C//DTD SVG 1.1//EN'  'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'><img src="img/faceicon.png" alt=""></i
      ></a>
      <!-- Instagram -->
      <a
        class="btn btn-link btn-floating btn-lg text-dark m-1"
        href="#!"
        role="button"
        data-mdb-ripple-color=""
        ><i class="fab fa-instagram"><?xml version="1.0" ?><!DOCTYPE svg  PUBLIC '-//W3C//DTD SVG 1.1//EN'  'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'><img src="img/igicon.png" alt=""></i
      ></a>

    
    </section>
    <!-- Section: Social media -->
  </div>
  <!-- Grid container -->

  <!-- Copyright -->
  <div class="text-center text-dark p-3" style="background-color: rgba(0, 0, 0, 0.2);">
    © 2023 Mike:
    <a class="text-dark" href="https://mdbootstrap.com/">https://github.com/MichaelPinto87</a>
  </div>
  <!-- Copyright -->
</footer>

<script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
      crossorigin="anonymous"
    ></script>
   
    <link href="https://fonts.cdnfonts.com/css/nikeflix" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script src="main.js"></script>
  </body>
</html>
